import argparse
import matplotlib.pyplot as plt


def plot_per_turn_number(args):
    
    if args.dataset_name == "QReCC":
        max_turn_num = 12
        y_r100 = {
            "Original": [0.9726071705253723, 0.14833357453135615, 0.15922582425367848, 0.15306291448480056, 0.1615366183069751, 0.13666629112212708, 0.14046242774566475, 0.16913145539906105, 0.15610859728506787, 0.1810344827586207, 0.15833333333333333, 0.14285714285714285],
            "All History": [0.9726071705253723, 0.892986986064919, 0.9153221104301257, 0.9123259553671662, 0.9023297608155796, 0.8993728406188974, 0.8763806521031954, 0.9045774647887324, 0.8763197586726998, 0.8103448275862069, 0.8916666666666667, 0.8571428571428571],
            "Human rewrite": [0.9726071705253723, 0.9798082458012941, 0.9844373810109766, 0.9771282086422389, 0.9816135145732584, 0.9847284812978818, 0.9800715661987338, 0.9802816901408451, 0.9841628959276018, 0.9913793103448276, 0.9833333333333333, 1.0],
            "T5RQ": [0.9673013488599339, 0.8582241600558159, 0.827366257334168, 0.7829187306908552, 0.7622522110399512, 0.7583746432326873, 0.7265712450683549, 0.7357981220657278, 0.7202111613876321, 0.7543103448275862, 0.7333333333333333, 0.6666666666666666],
            "ConvGQR": [0.8885103065279926, 0.7561640268201428, 0.749600465206746, 0.7222251315549097, 0.6901832004530999, 0.7130426618596966, 0.7291394539949453, 0.7545774647887324, 0.7420814479638009, 0.7306034482758621, 0.675, 0.7142857142857143] 
        }        
    
    elif args.dataset_name == "TopiOCQA":
        max_turn_num = 16
        y_r100 = {
            "Original": [0.6439024390243903, 0.07804878048780488, 0.02926829268292683, 0.014634146341463415, 0.024390243902439025, 0.04390243902439024, 0.03902439024390244, 0.02926829268292683, 0.03414634146341464, 0.06341463414634146, 0.040268456375838924, 0.07017543859649122, 0.06741573033707865, 0.03389830508474576, 0.046511627906976744, 0.0],
            "All History": [0.6439024390243903, 0.5414634146341464, 0.34146341463414637, 0.24878048780487805, 0.15609756097560976, 0.11707317073170732, 0.06829268292682927, 0.05853658536585366, 0.04878048780487805, 0.01951219512195122, 0.006711409395973154, 0.008771929824561403, 0.011235955056179775, 0.01694915254237288, 0.0, 0.0],
            "Same Topic": [0.6439024390243903, 0.4975609756097561, 0.33658536585365856, 0.21951219512195122, 0.1951219512195122, 0.18048780487804877, 0.14146341463414633, 0.13170731707317074, 0.16585365853658537, 0.14146341463414633, 0.087248322147651, 0.11403508771929824, 0.0898876404494382, 0.15254237288135594, 0.13953488372093023, 0.2],
            "T5RQ": [0.6341463414634146, 0.5707317073170731, 0.5609756097560976, 0.4585365853658537, 0.375609756097561, 0.3121951219512195, 0.3024390243902439, 0.2975609756097561, 0.2975609756097561, 0.23414634146341465, 0.22818791946308725, 0.2719298245614035, 0.25842696629213485, 0.2033898305084746, 0.23255813953488372, 0.1],
            "ConvGQR": [0.5219512195121951, 0.5414634146341464, 0.5219512195121951, 0.47804878048780486, 0.47804878048780486, 0.4634146341463415, 0.34146341463414637, 0.375609756097561, 0.4146341463414634, 0.28292682926829266, 0.3288590604026846, 0.4649122807017544, 0.30337078651685395, 0.23728813559322035, 0.3953488372093023, 0.4] 
        }
    
    elif args.dataset_name == "INSCIT":
        max_turn_num = 7
        y_r100 = {
            "Original": [0.5718228530728531, 0.3878938126226629, 0.4058538404175988, 0.41648727984344425, 0.45209100033456007, 0.44949589883800406, 0.35992907801418444],
            "All History": [0.5718228530728531, 0.5218055985951864, 0.3856077554064131, 0.43775549032398337, 0.35355191256830604, 0.335882319434951, 0.3570921985815602],
            "Same Topic": [0.5718228530728531, 0.47591157938229517, 0.487621178225205, 0.5020303326810176, 0.533149325303892, 0.5050609478241056, 0.6347517730496454],
            "T5RQ": [0.5704339641839642, 0.5166356781324243, 0.5363907531692766, 0.5240976299195478, 0.5800992528158804, 0.524057302346776, 0.5301418439716312],
            "ConvGQR": [0.5722603785103786, 0.4944168990806735, 0.5004474272930649, 0.4962383126766688, 0.49286271885803506, 0.4468643198906357, 0.5570921985815603]
        }
        
    
    x = range(1, max_turn_num+1)
    plt.figure(figsize=(7, 5))
    for label, value in y_r100.items():
        plt.plot(x, value, label=label)
    
    plt.title(f'Dataset: {args.dataset_name}')
    plt.xlabel('Turn Number')
    plt.ylabel('Recall@100')
    plt.ylim(0.0, 0.91)
    plt.legend()
    plt.tight_layout()

    plt.show()


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--dataset_name", type=str, default="TopiOCQA", choices=["QReCC", "TopiOCQA", "INSCIT"])
    args = parser.parse_args()
    
    plot_per_turn_number(args)